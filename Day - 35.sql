CREATE TABLE uber_transactions (
    transaction_id INT PRIMARY KEY AUTO_INCREMENT,
    user_id INT,
    spend DECIMAL(10,2),
    transaction_date DATE
);

INSERT INTO uber_transactions (user_id, spend, transaction_date) VALUES
(1, 250.00, '2024-01-05'),
(1, 120.50, '2024-01-10'),
(1, 330.00, '2024-02-02'),
(1, 145.75, '2024-02-15'),
(1, 210.00, '2024-03-01'),

(2, 99.99, '2024-01-07'),
(2, 150.00, '2024-01-20'),
(2, 199.50, '2024-02-05'),
(2, 220.75, '2024-02-22'),
(2, 180.00, '2024-03-10'),

(3, 300.00, '2024-01-03'),
(3, 275.50, '2024-01-15'),
(3, 150.00, '2024-02-01'),
(3, 400.00, '2024-02-18'),
(3, 250.00, '2024-03-05'),

(4, 110.00, '2024-01-09'),
(4, 90.75, '2024-01-18'),
(4, 130.00, '2024-02-04'),
(4, 175.00, '2024-02-25'),
(4, 200.00, '2024-03-12'),

(5, 500.00, '2024-01-02'),
(5, 450.50, '2024-01-14'),
(5, 600.00, '2024-02-10'),
(5, 350.75, '2024-02-27'),
(5, 400.00, '2024-03-15'),

(6, 220.00, '2024-01-06'),
(6, 180.50, '2024-01-22'),
(6, 250.00, '2024-02-11'),
(6, 270.75, '2024-02-28'),
(6, 300.00, '2024-03-20'),

(7, 99.00, '2024-01-08'),
(7, 120.00, '2024-01-19'),
(7, 140.50, '2024-02-09'),
(7, 200.00, '2024-03-01'),
(7, 175.00, '2024-03-22'),

(8, 310.00, '2024-01-04'),
(8, 400.00, '2024-01-17'),
(8, 450.00, '2024-02-07'),
(8, 380.50, '2024-02-26'),
(8, 500.00, '2024-03-18'),

(9, 150.00, '2024-01-11'),
(9, 200.00, '2024-01-25'),
(9, 250.75, '2024-02-14'),
(9, 175.00, '2024-03-05'),
(9, 225.00, '2024-03-25'),

(10, 275.00, '2024-01-13'),
(10, 325.50, '2024-01-28'),
(10, 400.00, '2024-02-12'),
(10, 450.75, '2024-02-29'),
(10, 500.00, '2024-03-28');

/* Assume you are given the table below on Uber transactions made by users. 
Write a query to obtain the third transaction of every user. Output the user id, spend, and transaction date.*/

SELECT * FROM uber_transactions;

SELECT user_id,
        spend,
        transaction_date
FROM ( SELECT user_id,
        spend,
        transaction_date,
        ROW_NUMBER() OVER ( PARTITION BY user_id ORDER BY transaction_date ASC) AS rnk
FROM uber_transactions) AS temp_tbl
WHERE rnk = 3;